# ЭЗС — Streamlit дашборд обращений (v4 safe)

Главная цель v4 — **работать без падений** и всегда давать “выход” пользователю.

Что добавлено/усилено:
- выбор источника: **Google Sheets** или **загрузка CSV/Excel** (если Google недоступен/не расшарен)
- блок “Диагностика”: показывает первые строки и позволяет **вручную выбрать колонки**
- безопасная сводка Производитель×Тематика: `crosstab` + итоги вручную + fallback без итогов
- `on_bad_lines="skip"` при чтении CSV
- при критичных ошибках — понятное сообщение и `st.stop()` вместо падения

Запуск:
```bash
pip install -r requirements.txt
streamlit run app.py
```
